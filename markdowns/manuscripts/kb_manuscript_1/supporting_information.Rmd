---
title: "SUPPORTING INFORMATION"
geometry: margin=0.5in
output:
  pdf_document:
    toc: false
---

```{r load_libraries, echo=FALSE, message=FALSE}
  if (!require("pacman")) install.packages("pacman")
  pacman::p_load(tidyverse, patchwork, knitr, kableExtra, forcats,
                 RColorBrewer, stringi, pBrackets)
```

```{r global_options, include=FALSE}
  knitr::opts_chunk$set(fig.path='figures/', warning=FALSE, message=FALSE, cache=FALSE, echo=FALSE)
```

```{r, echo=FALSE}
  emissions <- readRDS("../../../r_data/emissions_factors.RDS")
  samples <- readRDS("../../../r_data/samples.RDS")
  fuels <- readRDS("../../../r_data/fuel_properties.RDS")
  pol_properties <- readRDS("../../../r_data/pol_properties.RDS")
```

```{r, echo=FALSE}
  mod_1 <- readRDS("model_confint/mod_1.RDS")
  mod_2 <- readRDS("model_confint/mod_2.RDS")
  mod_3 <- readRDS("model_confint/mod_3.RDS")
  mod_4 <- readRDS("model_confint/mod_4.RDS")
  mod_5 <- readRDS("model_confint/mod_5.RDS")
  mod_6 <- readRDS("model_confint/mod_6.RDS")
  mod_7 <- readRDS("model_confint/mod_7.RDS")
```

\begin{center}
\LARGE{Household Cookstoves: A Comprehensive Laboratory Assessment of Air Pollutant Emissions}
\end{center}

Kelsey R. Bilsback, Jordyn Dahlke, Kristen Fedak, Nicholas Good, Arsineh Hecobian, Pierre Herckes, Christian Lâ€™Orange, John Mehaffy, Amy Sullivan, Jessica Tryner, Lizette Van Zyl, Ethan Walker, Ander Wilson, Jennifer L. Peel, John Volckens

\tableofcontents
\newpage

# 1. Stove and fuel information

## Stove-fuel test matrix

```{r test_matrix, eval=FALSE}
  samples %>%
    dplyr::select(id, stove, fuel, type) %>%
    dplyr::mutate(stove = as.character(stove),
                  stove = ifelse(stove == "lpg", "pressure lpg", stove)) %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "clay ring",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "gasifier",
                                         "pressure lpg",
                                         "wick kerosene",
                                         "pressure kerosene"),
                  fuel = 
                    fuel %>% 
                    factor %>% 
                    forcats::fct_relevel("oak",
                                         "eucalyptus",
                                         "douglas fir",
                                         "lump hardwood (med.)",
                                         "lump hardwood (sm.)",
                                         "coconut charcoal",
                                         "west slope pellets",
                                         "eucalyptus pellets",
                                         "lpg",
                                         "kerosene")) %>%
    dplyr::filter(type == "SF") %>%
                 dplyr::group_by(stove, fuel) %>%
                 dplyr::filter(!grepl("^27|^28|^29|^30", id)) %>%
                 dplyr::summarise(id = paste(id, collapse = ", ")) %>%
    ggplot(aes(x = stove, y = fuel)) + 
      geom_tile(colour = "white", width = 0.9, height = 0.9, aes(fill = id, order = id)) +
      theme_bw() +
      theme(legend.position = "none") +
      theme(axis.text.x = element_text(angle = 35, hjust = 1, vjust = 0.75)) +
      theme(text = element_text(size = 20)) +
      geom_text(aes(label = stringr::str_wrap(id, 9), size = 5)) +
      xlab("") +
      ylab("")
```

```{r, echo=FALSE, out.width = '100%'}
  knitr::include_graphics("test_matrix.png")
```

## Stove information

```{r}
  tibble::data_frame("id" = c("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k"),
                     "stove name" = c("three-stone fire",
                                      "chulha",
                                      "rocket-elbow",
                                      "built-in plancha (with chimney)",
                                      "fan rocket-elbow",
                                      "forced-draft gasifier",
                                      "ceramic charcoal",
                                      "metal charcoal",
                                      "wick kerosene",
                                      "pressurized kerosene",
                                      "lpg"),
                     "make" = c("artisan",
                                "artisan",
                                "Envirofit",
                                "Envirofit",
                                "Biolite",
                                "Philips",
                                "artisan",
                                "BURN",
                                "Cook 'n Lite",
                                "Butterfly",
                                "WokSmith"),
                     "model" = c("artisan",
                                "artisan",
                                "G3300",
                                "HM5000",
                                "Homestove$^1$",
                                "HD4012",
                                "artisan",
                                "jikokoa",
                                "82",
                                "2412",
                                "WS-C1-25K"),
                     "photo" = c("", "", "", "", "", "", "", "", "", "", "")) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c') %>%
    kable_styling(position = "center", latex_options = c("striped"), font_size = 10) %>%
    footnote(general_title = "Notes: ", threeparttable = TRUE,
             number = c("Stove model in the picture is newer than the one tested"))
```

## Fuel properties

```{r}
  fuels %>%
    dplyr::mutate(carbon_fraction = format(round(carbon_fraction, 2), nsmall = 2, scientific = FALSE),
                  carbon_fraction = ifelse(carbon_fraction == "0.82", "0.82$^+$", carbon_fraction),
                  lhv = ifelse(grepl("00", lhv), paste0(lhv, "$^+$"), lhv)) %>%
    dplyr::rename("lower heating value*" = "lhv",
                  "fraction of carbon in fuel" = "carbon_fraction") %>%
    kable(escape = FALSE, booktabs = TRUE, align = "c",
          longtable = TRUE) %>%
    kable_styling(position = "center", font_size = 10,
                  latex_options = "repeat_header") %>%
    footnote(general = "*in units of kilojoules per kilogram; $^+$estimated values", escape = FALSE)
```

# 3. Intrumentation

```{r, echo=FALSE, out.width = '100%'}
  knitr::include_graphics("schematic.png")
```

# 4. Carcinogenic compound classifications

```{r}
  tibble::data_frame("pollutant" = c("benzene",
                                    "formaldehyde",
                                    "styrene",
                                    "acetaldehyde",
                                    "isoprene",
                                    "benz[a]anthracene",
                                    "benzo[a]pyrene",
                                    "benzo[b]fluoranthene",
                                    "benzo[j]fluoranthene",
                                    "benzo[k]fluoranthene",
                                    "cyclopenta[cd]pyrene",
                                    "dibenzo[a,h]anthracene",
                                    "indeno[1,2,3-cd]pyrene"),
                     "phase" = c("gas",
                                 "gas",
                                 "gas",
                                 "gas",
                                 "gas",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle"),
                     "NTP$^1$" = c("Known to be a human carcinogen",
                                   "Known to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "NA",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen"),
                     "IARC$^2$" = c("Group 1: Carcinogenic to humans",
                                    "Group 1: Carcinogenic to humans",
                                    "Group 2A: Probably carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 1: Carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2A: Probably carcinogenic to humans",
                                    "Group 2A: Probably carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans")) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c') %>%
    kable_styling(position = "center", latex_options = c("striped"), font_size = 8) %>%
    footnote(general_title = "Notes: ", threeparttable = TRUE,
             number = c("National Toxicology Program (NTP)",
                        "International Agency for Research on Cancer (IARC)"))
```

# 5. PM$_{2.5}$ mass balance

```{r, echo=FALSE, out.width = '75%', fig.align="center"}
  knitr::include_graphics("../../emissions_factors/figures/mass_balance-1.png")
```

# 6. Linear regression model

## Coefficients and confidence intervals for models plotted in Figure 4

* stove type only: 
\[ln(EF) = \alpha_i\]

```{r}
  mod_1 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

* PM$_{2.5}$ mass only:
\[ln(EF) = \alpha + \beta \cdot PM_{2.5}\]

```{r}
  mod_2 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta$" = "pm_mass") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

* CO only:
\[ln(EF) = \alpha + \beta \cdot CO\]

```{r}
  mod_3 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta$" = "co") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

* PM$_{2.5}$ mass and CO:
\[ln(EF) = \alpha + \beta_1 \cdot CO + \beta_2 \cdot PM_{2.5}\]

```{r}
  mod_4 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta_1$" = "co",
                  "$\\beta_2$" = "pm_mass") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

* PM$_{2.5}$ mass and stove type:
\[ln(EF) = \alpha_i + \beta \cdot PM_{2.5}\]

```{r}
  mod_5 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta$" = "pm_mass") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

* CO and stove type:
\[ln(EF) = \alpha_i + \beta \cdot CO\]

```{r}
  mod_6 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta$" = "co") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

* PM$_{2.5}$ mass, CO, and stove type:
\[ln(EF) = \alpha_i + \beta_1 \cdot CO + \beta_2 \cdot PM_{2.5}\]

```{r}
  mod_7 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta_1$" = "co",
                  "$\\beta_2$" = "pm_mass") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## R-squared plot, model coefficients, and confidence intervals for 118 pollutant species measured

```{r, echo=FALSE, out.width = '60%', fig.align="center"}
  knitr::include_graphics("figures/models_all-1.png")
```

* stove type only: 
\[ln(EF) = \alpha_i\]

* PM$_{2.5}$ mass only:
\[ln(EF) = \alpha + \beta \cdot PM_{2.5}\]

* CO only:
\[ln(EF) = \alpha + \beta \cdot CO\]

* PM$_{2.5}$ mass and CO:
\[ln(EF) = \alpha + \beta_1 \cdot CO + \beta_2 \cdot PM_{2.5}\]

* PM$_{2.5}$ mass and stove type:
\[ln(EF) = \alpha_i + \beta \cdot PM_{2.5}\]

* CO and stove type:
\[ln(EF) = \alpha_i + \beta \cdot CO\]

* PM$_{2.5}$ mass, CO, and stove type:
\[ln(EF) = \alpha_i + \beta_1 \cdot CO + \beta_2 \cdot PM_{2.5}\]

# 7. Disaggregated data tables

```{r}
  samples <-
    samples %>%
    dplyr::select(id, stove, fuel, stovecat, fuelcat) %>%
    dplyr::mutate(stove = as.character(stove),
                  stove = ifelse(stove == "lpg", "pressure lpg", stove)) %>%
    dplyr::filter(!grepl("^G|^27|^28|^29|^30", id)) %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "pressure lpg",
                                         "pressure kerosene",
                                         "wick kerosene"),
                  fuel = 
                    fuel %>% 
                    factor %>% 
                    forcats::fct_relevel("oak",
                                         "eucalyptus",
                                         "douglas fir",
                                         "lump hardwood (med.)",
                                         "lump hardwood (sm.)",
                                         "coconut charcoal",
                                         "west slope pellets",
                                         "eucalyptus pellets",
                                         "lpg",
                                         "kerosene"))
```

```{r, echo=FALSE}
  emissions <-
    emissions %>%
    dplyr::filter(grepl("energy_delivered_ef|mass_fuel_ef|energy_fuel_ef|emissions_rate", metric)) %>%
    dplyr::select(-qc, -units) %>%
    tidyr::spread("metric", "val") %>%
    dplyr::full_join(samples %>%
                        dplyr::select(id, stove, fuel, stovecat, fuelcat), by = "id") %>%
    dplyr::mutate(id = as_factor(id)) %>%
    dplyr::select(pol, pol_category, pol_subcategory, id, stove, fuel, energy_delivered_ef, mass_fuel_ef,
                  energy_fuel_ef, emissions_rate, lod, bg) %>%
    dplyr::mutate(stove = as.character(stove),
                  stove = ifelse(stove == "lpg", "pressure lpg", stove)) %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "pressure lpg",
                                         "pressure kerosene",
                                         "wick kerosene"),
                  fuel = 
                    fuel %>% 
                    factor %>% 
                    forcats::fct_relevel("oak",
                                         "eucalyptus",
                                         "douglas fir",
                                         "lump hardwood (med.)",
                                         "lump hardwood (sm.)",
                                         "coconut charcoal",
                                         "west slope pellets",
                                         "eucalyptus pellets",
                                         "lpg",
                                         "kerosene"))
```

## Fine particulate matter

```{r}
  fine_pm <-
    emissions %>%
    dplyr::filter(grepl("pm", pol)) %>%
    dplyr::full_join(samples %>%
                       dplyr::select(id, stove, fuel),
                     by = c("id", "stove", "fuel")) %>%
    dplyr::select(-pol_category, -pol_subcategory) %>%
    dplyr::mutate(pol = "PM$_{2.5}$ mass") %>%
    dplyr::mutate(energy_delivered_ef = signif(energy_delivered_ef, 3),
                  mass_fuel_ef = signif(mass_fuel_ef, 3),
                  energy_fuel_ef = signif(energy_fuel_ef, 3),
                  emissions_rate = signif(emissions_rate, 3),
                  energy_delivered_ef = as.character(energy_delivered_ef),
                  mass_fuel_ef = as.character(mass_fuel_ef),
                  energy_fuel_ef = as.character(energy_fuel_ef),
                  emissions_rate = as.character(emissions_rate)) %>%
    dplyr::mutate(energy_delivered_ef = ifelse(lod == "below", paste0(energy_delivered_ef, "*"), energy_delivered_ef),
                  mass_fuel_ef = ifelse(lod == "below", paste0(mass_fuel_ef, "*"), mass_fuel_ef),
                  energy_fuel_ef = ifelse(lod == "below", paste0(energy_fuel_ef, "*"), energy_fuel_ef),
                  emissions_rate = ifelse(lod == "below", paste0(emissions_rate, "*"), emissions_rate),
                  energy_delivered_ef = ifelse(bg == "below", "BB", energy_delivered_ef),
                  mass_fuel_ef = ifelse(bg == "below", "BB", mass_fuel_ef ),
                  energy_fuel_ef = ifelse(bg == "below", "BB", energy_fuel_ef),
                  emissions_rate = ifelse(bg == "below", "BB", emissions_rate)) %>%
    dplyr::select(-lod, -bg)
```

```{r}
  fine_pm %>%
    dplyr::arrange(stove, fuel, id) %>%
    dplyr::rename("pollutant" = "pol",
                  "per-energy-delivered$^1$" = "energy_delivered_ef",
                  "per-time$^2$" = "emissions_rate",
                  "per-fuel-mass$^3$" = "mass_fuel_ef",
                  "per-fuel-energy$^4$" = "energy_fuel_ef") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("repeat_header", "striped"), font_size = 8) %>%
    footnote(general_title = "Notes: ", general = "Results reported to three significant figures; BB indicates a value below background; * indicates a value below the limit of detection; NA indicates a value with a measurement error", threeparttable = TRUE,
             number = c("mg/MJ$_{delivered}$", "mg/hour", "mg/kg$_{fuel}$", "mg/kJ$_{fuel}$"), escape = FALSE)
```

\newpage

## Organic carbon, organic matter, elemental carbon

```{r}
  oc_ec_om_samples <-
    expand.grid(samples %>%
                  dplyr::select(id),
          emissions %>%
                  dplyr::filter(grepl("^oc$|^om$|^ec$", pol)) %>%
                  dplyr::select(pol_subcategory) %>%
                  dplyr::distinct())

  oc_ec_om <-
    emissions %>%
    dplyr::filter(grepl("^oc$|^om$|^ec$", pol)) %>%
    dplyr::full_join(samples %>%
                       dplyr::select(id, stove, fuel),
                     by = c("id", "stove", "fuel")) %>%
    dplyr::select(-pol_category, -pol) %>%
    dplyr::mutate(energy_delivered_ef = signif(energy_delivered_ef, 3),
                  mass_fuel_ef = signif(mass_fuel_ef, 3),
                  energy_fuel_ef = signif(energy_fuel_ef, 3),
                  emissions_rate = signif(emissions_rate, 3),
                  energy_delivered_ef = as.character(energy_delivered_ef),
                  mass_fuel_ef = as.character(mass_fuel_ef),
                  energy_fuel_ef = as.character(energy_fuel_ef),
                  emissions_rate = as.character(emissions_rate)) %>%
    dplyr::mutate(energy_delivered_ef = ifelse(lod == "below", paste0(energy_delivered_ef, "*"), energy_delivered_ef),
                  mass_fuel_ef = ifelse(lod == "below", paste0(mass_fuel_ef, "*"), mass_fuel_ef),
                  energy_fuel_ef = ifelse(lod == "below", paste0(energy_fuel_ef, "*"), energy_fuel_ef),
                  emissions_rate = ifelse(lod == "below", paste0(emissions_rate, "*"), emissions_rate),
                  energy_delivered_ef = ifelse(bg == "below", "BB", energy_delivered_ef),
                  mass_fuel_ef = ifelse(bg == "below", "BB", mass_fuel_ef ),
                  energy_fuel_ef = ifelse(bg == "below", "BB", energy_fuel_ef),
                  emissions_rate = ifelse(bg == "below", "BB", emissions_rate)) %>%
    dplyr::select(-lod, -bg)
```

```{r}
  oc_ec_om %>%
    dplyr::arrange(pol_subcategory, stove, fuel, id) %>%
    dplyr::rename("pollutant" = "pol_subcategory",
                  "per-energy-delivered$^1$" = "energy_delivered_ef",
                  "per-time$^2$" = "emissions_rate",
                  "per-fuel-mass$^3$" = "mass_fuel_ef",
                  "per-fuel-energy$^4$" = "energy_fuel_ef") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("repeat_header", "striped"), font_size = 8) %>%
    footnote(general_title = "Notes: ", general = "Results reported to three significant figures; BB indicates a value below background; * indicates a value below the limit of detection; NA indicates a value with a measurement error", threeparttable = TRUE,
             number = c("mg/MJ$_{delivered}$", "mg/hour", "mg/kg$_{fuel}$", "mg/kJ$_{fuel}$"), escape = FALSE)
```

## Inorganic ions

```{r, echo=FALSE, eval=FALSE}
  emissions %>%
    dplyr::filter(pol_category == "ions") %>%
    dplyr::left_join(dplyr::select(pol_properties, pol, mw), by = "pol") %>%
    dplyr::select(-pol_category, -pol_subcategory) %>%
    dplyr::mutate(pol = as_factor(pol),
                  pol = fct_reorder(pol, mw)) %>%
    dplyr::select(-mw) %>%
    dplyr::mutate(energy_delivered_ef = format(round(energy_delivered_ef, 2), nsmall = 2, scientific = FALSE),
                  mass_fuel_ef = format(round(mass_fuel_ef, 2), nsmall = 2, scientific = FALSE),
                  energy_delivered_ef = as.character(energy_delivered_ef),
                  mass_fuel_ef = as.character(mass_fuel_ef)) %>%
    dplyr::rename("pollutant" = "pol",
                  "per-energy-delivered" = "energy_delivered_ef",
                  "per-mass-fuel" = "mass_fuel_ef") %>%
    dplyr::arrange(pollutant, stove, fuel) %>%
    kable(escape = FALSE, booktabs = TRUE, align = "c",
          longtable = TRUE) %>%
    kable_styling(position = "left", font_size = 9,
                  latex_options = "repeat_header") %>%
    footnote(general = "BB is below background; * indicates a value below limit of detection; ** indicates a value below limit of quantification")
```

## Ultrafine particles

```{r, echo=FALSE, eval=FALSE}
  emissions %>%
    dplyr::filter(pol_category == "smps") %>%
    dplyr::select(-pol_category, -pol_subcategory) %>%
    dplyr::mutate(id =
                    id %>%
                    as_factor) %>%
    dplyr::mutate(energy_delivered_ef = format(energy_delivered_ef, format = "e", digits = 3),
                  mass_fuel_ef = format(mass_fuel_ef, 2, format = "e", digits = 3),
                  energy_delivered_ef = as.character(energy_delivered_ef),
                  mass_fuel_ef = as.character(mass_fuel_ef)) %>%
    dplyr::rename("pollutant" = "pol",
                  "per-energy-delivered" = "energy_delivered_ef",
                  "per-mass-fuel" = "mass_fuel_ef") %>%
    dplyr::arrange(pollutant, stove, fuel) %>%
    kable(escape = FALSE, booktabs = TRUE, align = "c",
          longtable = TRUE) %>%
    kable_styling(position = "left", font_size = 9,
                  latex_options = "repeat_header") %>%
    footnote(general = "BB is below background; * indicates a value below limit of detection; ** indicates a value below limit of quantification")
```

## Carbonyl compounds

```{r, echo=FALSE, eval=FALSE}
  emissions %>%
    dplyr::filter(pol_category == "carbonyls") %>%
    dplyr::mutate(pol = ifelse(pol == "o_tolualdehyde", "o-tolualdehyde", pol),
                  pol = ifelse(pol == "m_p_tolualdehyde", "m,p-tolualdehyde", pol),
                  pol = ifelse(pol == "2_5_dimethylbenzaldehyde", "2,5-dimethylbenzaldehyde", pol)) %>%
    dplyr::left_join(dplyr::select(pol_properties, pol, mw), by = "pol") %>%
    dplyr::select(-pol_category) %>%
    dplyr::mutate(pol = as_factor(pol),
                  pol = fct_reorder(pol, mw)) %>%
    dplyr::select(-mw) %>%
    dplyr::mutate(energy_delivered_ef = format(round(energy_delivered_ef, 2), nsmall = 2, scientific = FALSE),
                  mass_fuel_ef = format(round(mass_fuel_ef, 2), nsmall = 2, scientific = FALSE),
                  energy_delivered_ef = as.character(energy_delivered_ef),
                  mass_fuel_ef = as.character(mass_fuel_ef)) %>%
    dplyr::rename("pollutant" = "pol",
                  "pollutant category" = "pol_subcategory",
                  "per-energy-delivered" = "energy_delivered_ef",
                  "per-mass-fuel" = "mass_fuel_ef") %>%
    dplyr::arrange(pollutant, stove, fuel) %>%
    kable(escape = FALSE, booktabs = TRUE, align = "c",
          longtable = TRUE) %>%
    kable_styling(position = "left", font_size = 9,
                  latex_options = "repeat_header") %>%
    footnote(general = "BB is below background; * indicates a value below limit of detection; ** indicates a value below limit of quantification")
```

## Volatile organic compounds

## Polycyclic Aromatic Hydrocarbons

```{r, echo=FALSE, eval=FALSE}
  emissions %>%
    dplyr::filter(pol_category == "pahs") %>%
    dplyr::select(-pol_category) %>%
    dplyr::mutate(pol_subcategory = 
                    pol_subcategory %>% 
                    factor %>% 
                    forcats::fct_relevel("two rings",
                                         "three rings",
                                         "four rings",
                                         "five rings",
                                         "six rings")) %>%
    dplyr::mutate(energy_delivered_ef = format(round(energy_delivered_ef, 2), nsmall = 2, scientific = FALSE),
                  mass_fuel_ef = format(round(mass_fuel_ef, 2), nsmall = 2, scientific = FALSE),
                  energy_delivered_ef = as.character(energy_delivered_ef),
                  mass_fuel_ef = as.character(mass_fuel_ef),
                  pol = gsub("indeno\\(1,2,3\\) cd pyrene", "indeno\\[1,2,3-cd\\]pyrene", pol),
                  pol = gsub("\\(ah\\)",  "\\[a,h\\]", pol),
                  pol = gsub("b\\[",  "benzo\\[", pol)) %>%
    dplyr::arrange(pol_subcategory, pol, stove, fuel) %>%
    dplyr::rename("pollutant" = "pol",
                  "pollutant category" = "pol_subcategory",
                  "per-energy-delivered" = "energy_delivered_ef",
                  "per-mass-fuel" = "mass_fuel_ef") %>%
    kable(escape = FALSE, booktabs = TRUE, align = "c",
          longtable = TRUE) %>%
    kable_styling(position = "left", font_size = 9,
                  latex_options = "repeat_header") %>%
    footnote(general = "BB is below background; * indicates a value below limit of detection; ** indicates a value below limit of quantification")
```

## Carbohydrates