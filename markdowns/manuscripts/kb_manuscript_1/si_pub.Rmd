---
title: "SUPPORTING INFORMATION"
geometry: margin=1in
output:
  pdf_document:
    toc: false
---

```{r load_libraries, echo=FALSE, message=FALSE}
  if (!require("pacman")) install.packages("pacman")
  pacman::p_load(tidyverse, patchwork, knitr, kableExtra, forcats,
                 RColorBrewer, stringi, pBrackets)
```

```{r global_options, include=FALSE}
  knitr::opts_chunk$set(fig.path='figures/', warning=FALSE, message=FALSE, cache=FALSE, echo=FALSE)
```

```{r, echo=FALSE}
  emissions <- readRDS("../../../r_data/emissions_factors.RDS")
  fuel_burnt <- readRDS("../../../r_data/fuel_merged.RDS")
  times <- readRDS("../../../r_data/test_times.RDS")
  samples <- readRDS("../../../r_data/samples.RDS")
  fuels <- readRDS("../../../r_data/fuel_properties.RDS")
  pol_properties <- readRDS("../../../r_data/pol_properties.RDS")
```

```{r, echo=FALSE}
  mod_1 <- readRDS("model_confint/mod_1.RDS")
  mod_2 <- readRDS("model_confint/mod_2.RDS")
  mod_3 <- readRDS("model_confint/mod_3.RDS")
  mod_4 <- readRDS("model_confint/mod_4.RDS")
  mod_5 <- readRDS("model_confint/mod_5.RDS")
  mod_6 <- readRDS("model_confint/mod_6.RDS")
  mod_7 <- readRDS("model_confint/mod_7.RDS")
```

```{r, echo=FALSE}
  mod_1_c <- readRDS("model_confint/mod_1_c.RDS")
  mod_2_c <- readRDS("model_confint/mod_2_c.RDS")
  mod_3_c <- readRDS("model_confint/mod_3_c.RDS")
  mod_4_c <- readRDS("model_confint/mod_4_c.RDS")
  mod_5_c <- readRDS("model_confint/mod_5_c.RDS")
  mod_6_c <- readRDS("model_confint/mod_6_c.RDS")
  mod_7_c <- readRDS("model_confint/mod_7_c.RDS")
```

```{r, echo=FALSE}
  samples <-
    samples %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "forced-draft gasifier",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg") %>%
                    forcats::fct_recode("Three-stone fire" = "three-stone fire",
                                         "Mud chulha" = "chulha",
                                         "Rocket elbow" = "rocket elbow",
                                         "Built-in plancha" = "built-in plancha",
                                         "Fan rocket elbow" = "fan rocket-elbow",
                                         "Gasifier" = "forced-draft gasifier",
                                         "Ceramic jiko" = "ceramic charcoal",
                                          "Metal jiko" = "metal charcoal",
                                          "Wick kerosene" = "wick kerosene",
                                         "Pressure kerosene" = "pressure kerosene",
                                          "LPG" = "lpg"))
```

\begin{center}
\LARGE{Household Cookstoves: A Comprehensive Laboratory Assessment of Air Pollutant Emissions}
\end{center}

Kelsey R. Bilsback, Jordyn Dahlke, Kristen Fedak, Nicholas Good, Arsineh Hecobian, Pierre Herckes, Christian Lâ€™Orange, John Mehaffy, Amy Sullivan, Jessica Tryner, Lizette Van Zyl, Ethan Walker, Ander Wilson, Jennifer L. Peel, John Volckens

\tableofcontents
\newpage

# S1: Make and model of each stove type

```{r}
  tibble::data_frame("Stove type" = c("Three-stone fire",
                                      "Mud chulha",
                                      "Rocket elbow",
                                      "Built-in plancha (with chimney)",
                                      "Fan rocket-elbow",
                                      "Forced-draft gasifier",
                                      "Ceramic jiko",
                                      "Metal jiko",
                                      "Wick kerosene",
                                      "Pressurized kerosene",
                                      "Liquefied petroleum (LPG) stove"),
                     "Stove make" = c("Artisan",
                                "Artisan",
                                "Envirofit",
                                "Envirofit",
                                "Biolite",
                                "Philips",
                                "Artisan",
                                "BURN",
                                "Cook 'n Lite",
                                "Butterfly",
                                "WokSmith"),
                     "Stove model" = c("Artisan",
                                "Artisan",
                                "G3300",
                                "HM5000",
                                "Homestove$^1$",
                                "HD4012",
                                "Artisan",
                                "jikokoa",
                                "82",
                                "2412",
                                "WS-C1-25K")) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c') %>%
    kable_styling(position = "center", font_size = 12)
```

# S2: Fuel use by stove type

Fuel use by stove type (including all fuel types), where the mean and range of are indicated by the markers and bars, respectively.

```{r}
  fuel_burnt %>%
    dplyr::left_join(dplyr::select(samples, id, stove), by = "id") %>%
    dplyr::group_by(stove) %>%
    dplyr::summarise(fuel_mass = mean(mass_fuel_comb, na.rm = TRUE),
                     min = min(mass_fuel_comb, na.rm = TRUE),
                     max = max(mass_fuel_comb, na.rm = TRUE)) %>%
    dplyr::mutate(stove = forcats::fct_rev(stove)) %>%
    ggplot(aes(x = stove, y = fuel_mass)) +
      geom_point(size = 2) +
      geom_errorbar(aes(ymin = min, ymax = max), width = 0) +
      coord_flip() +
      theme_bw() +
      theme(text = element_text(size = 14),
            axis.title.y = element_blank()) +
      ylab("Fuel burned (grams)")
```

# S3: Sample duration by stove type

Sample duration by stove type (including all fuel types), where the mean and range of are indicated by the markers and bars, respectively.

```{r}
  times %>%
    dplyr::filter(var == "sample" | var == "refuel_1" | var == "shutdown") %>%
    dplyr::mutate(var = as.character(var),
                  var = ifelse(var == "refuel_1", "sample", var)) %>%
    tidyr::spread(var, value) %>%
    dplyr::mutate(duration = (shutdown - sample) / 60) %>%
    dplyr::left_join(dplyr::select(samples, id, stove), by = "id") %>%
    dplyr::group_by(stove) %>%
    dplyr::filter(!grepl("^27|^28|^29|^30", id)) %>%
    dplyr::summarise(dur = mean(duration, na.rm = TRUE),
                     min = min(duration, na.rm = TRUE),
                     max = max(duration, na.rm = TRUE)) %>%
    dplyr::mutate(stove = forcats::fct_rev(stove)) %>%
    ggplot(aes(x = stove, y = dur)) +
      geom_point(size = 2) +
      geom_errorbar(aes(ymin = min, ymax = max), width = 0) +
      coord_flip() +
      theme_bw() +
      theme(text = element_text(size = 14),
            axis.title.y = element_blank()) +
      ylab("Test duration (minutes)")
```

# S4: Firepower by stove type

Firepower by stove type (including all fuel types), where the mean and range of are indicated by the markers and bars, respectively.

# S5: Schematic of emissions sampling system

```{r, echo=FALSE, out.width = '100%'}
  knitr::include_graphics("images/schematic.png")
```

# S6: Table of emissions instrumentation

```{r}
  tibble::data_frame("Pollutant type" = c(""),
                     "Sampling media" = c(""),
                     "Analysis instrumentation" = c(""),
                     "Mesurement type" = c("")) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c') %>%
    kable_styling(position = "center", latex_options = c("scale_down"), font_size = 10)
```

# S7: Number of measurements by pollutant category

The following tables list the number of test measurements for each pollutant category discussed in the main manuscript. The number of tests includes measurements that were below the limit of detection or below the study-averaged laboratory background level by pollutant. Missing measurements are due to measurement error. There are eleven tables representing each of the stove types tested.

## S7.1: Three-stone fire

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "three-stone fire", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.2: Mud chulha

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "chulha", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.3: Rocket-elbow stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "rocket elbow", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.4: Built-in plancha stove (with chimney)

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "built-in plancha", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.5: Fan rocket-elbow stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "fan rocket-elbow", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.6: Forced-draft gasifier

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
    dplyr::filter(!grepl("^27|^28|^29|^30", id)) %>%
  dplyr::filter(stove == "forced-draft gasifier", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.7: Ceramic jiko

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "ceramic charcoal", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.8: Metal jiko

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "metal charcoal", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.9: Wick kerosene stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "wick kerosene", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.10: Pressure kerosene stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "pressure kerosene", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S7.11: Liquified petroleum gas stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "lpg", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory) %>%
  dplyr::select(pol_subcategory, id) %>%
  dplyr::distinct() %>%
  dplyr::summarise(num = n()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

# S8: Fraction of measurements below limit of detection

The following tables list the percent of test measurements that were below the limit of detection (LOD) by pollutant. There are eleven tables representing each of the stove types tested. To calculate the percent of measurements below LOD, the total number of tests that was below LOD was divided by the total number of measurements and multiplied by 100. Tests with measurement errors were not included in the total number of measurements. The total number of measurements for each pollutant are also listed. Pollutants that did not have any values below LOD are not included in the tables. Tables are sorted in order of most to least percent of tests with values below LOD.

## S8.1: Three-stone fire

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "three-stone fire", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 9)
```

\newpage

## S8.2: Mud chulha

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "chulha", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S8.3: Rocket-elbow stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "rocket elbow", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 9)
```

\newpage

## S8.4: Built-in plancha stove (with chimney)

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "built-in plancha", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S8.5: Fan rocket-elbow stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "fan rocket-elbow", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S8.6: Forced-draft gasifier

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
    dplyr::filter(!grepl("^27|^28|^29|^30", id)) %>%
  dplyr::filter(stove == "forced-draft gasifier", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S8.7: Ceramic jiko

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "ceramic charcoal", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S8.8: Metal jiko

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "metal charcoal", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S8.9: Wick kerosene stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "wick kerosene", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S8.10: Pressure kerosene stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "pressure kerosene", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S8.11: Liquified petroleum gas stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "lpg", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(lod == "below") / n(),
                   num_lod = sum(lod == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below LOD" = "fraction",
                "no. below LOD" = "num_lod",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

# S9: Fraction of measurements below background

The following tables list the percent of test measurements that were below the study-averaged laboratory background level by pollutant. There are eleven tables representing each of the stove types tested. To calculate the percent of measurements below background, the total number of tests that was below background was divided by the total number of measurements and multiplied by 100. Tests with measurement errors were not included in the total number of measurements. The total number of measurements for each pollutant are also listed. Pollutants that did not have any measurements below background were not included in the tables. Tables are sorted in order of most to least percent of tests with values below background.

## S9.1: Three-stone fire

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "three-stone fire", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.2: Mud chulha

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "chulha", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.3: Rocket-elbow stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "rocket elbow", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.4: Built-in plancha stove (with chimney)

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "built-in plancha", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.5: Fan rocket-elbow stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "fan rocket-elbow", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.6: Forced-draft gasifier

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
    dplyr::filter(!grepl("^27|^28|^29|^30", id)) %>%
  dplyr::filter(stove == "forced-draft gasifier", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.7: Ceramic jiko

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "ceramic charcoal", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.8: Metal jiko

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "metal charcoal", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.9: Wick kerosene stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "wick kerosene", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.10: Pressure kerosene stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "pressure kerosene", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

\newpage

## S9.11: Liquified petroleum gas stove

```{r, echo=FALSE}
  emissions %>%
  dplyr::left_join(samples %>%
                     dplyr::select(id, stove), by = "id") %>%
  dplyr::filter(stove == "lpg", !grepl("unc", pol), pol != "organic carbon") %>%
  dplyr::filter(metric == "energy_delivered_ef") %>%
  dplyr::group_by(pol_subcategory, pol) %>%
  dplyr::summarise(fraction = sum(bg == "below") / n(),
                   num_bg = sum(bg == "below"),
                   num = n()) %>%
  dplyr::filter(fraction != 0, !is.na(fraction)) %>%
  dplyr::mutate(fraction = format(round(fraction, 2)  * 100, nsmall = 0)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(pol_subcategory = as.character(pol_subcategory),
                pol_subcategory = ifelse(pol_subcategory == "pm_mass",
                                         "fine particulate matter", pol_subcategory),
                pol = ifelse(pol == "pm_mass", "fine particulate matter", pol),
                pol = ifelse(grepl("^co2$", pol), "carbon dioxide", pol),
                pol = ifelse(grepl("^co$", pol), "carbon monoxide", pol),
                pol = ifelse(grepl("^ch4$", pol), "methane", pol),
                pol = ifelse(grepl("ultrafines", pol), "ultrafine particles", pol),
                pol = ifelse(grepl("^om$", pol), "organic matter", pol),
                pol = ifelse(grepl("^oc$", pol), "organic carbon", pol),
                pol = ifelse(grepl("^ec$", pol), "elemental carbon", pol),
                pol = ifelse(grepl("pinene", pol), "alpha-pinene", pol),
                pol = ifelse(grepl("2_methyl_2_butene", pol), "2-methyl-2-butene", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("([0-9])(_)([a-z])", "\\1-\\3", pol),
                pol = gsub("([a-z])(_)([0-9])", "\\1,\\3", pol),
                pol = gsub("(m)(_)(p)", "\\1,\\3", pol),
                pol = gsub("([a-z])(_)([a-z])", "\\1-\\3", pol)) %>%
  dplyr::arrange(desc(fraction)) %>%
  dplyr::rename("category" = "pol_subcategory",
                "pollutant" = "pol",
                "\\% below background" = "fraction",
                "no. below background" = "num_bg",
                "no. of measurements" = "num") %>%
  kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
  kable_styling(position = "center", font_size = 10)
```

# S10: Fuel properties

```{r, echo=FALSE}
  fuels %>%
    dplyr::mutate(carbon_fraction = format(round(carbon_fraction, 2), nsmall = 2, scientific = FALSE),
                  carbon_fraction = ifelse(carbon_fraction == "0.82", "0.82$^2$", carbon_fraction),
                  hhv = ifelse(grepl("00", hhv), paste0(hhv, "$^2$"), hhv)) %>%
    dplyr::rename("HHV (kJ/kg)$^1$" = "hhv",
                  "carbon fraction$^1$" = "carbon_fraction",
                  "moisture content ($\\%$)" = "moisture",
                  "ash content ($\\%$)$^1$" = "ash",
                  "volatile content ($\\%$)$^1$" = "volatile_content",
                  "fixed carbon content ($\\%$)$^1$" = "fixed_carbon") %>%
    kable(escape = FALSE, booktabs = TRUE, align = "c") %>%
    kable_styling(position = "center", font_size = 10, latex_options = c("scale_down", "striped")) %>%
    footnote(general_title = "Notes: ", threeparttable = TRUE,
             number = c("dry basis", "estimated values"), escape = FALSE)
```

# S11: Particle emissions mass balance

PM$_{2.5}$ mass versus the sum of inorganic ions, elemental carbon, and organic matter. The error bars represent the uncertainty from the Sunset OCEC analyzer measurement. The black line represent the line $y = x$ and the blue lines represent $\pm 20 \%$ deviation from that line.

```{r, echo=FALSE, out.width = '75%', fig.align="center"}
  knitr::include_graphics("../../emissions_factors/figures/mass_balance-1.png")
```

# S12: Carcinogenic compound classifications

```{r}
  tibble::data_frame("pollutant" = c("benzene",
                                    "formaldehyde",
                                    "styrene",
                                    "acetaldehyde",
                                    "isoprene",
                                    "benz[a]anthracene",
                                    "benzo[a]pyrene",
                                    "benzo[b]fluoranthene",
                                    "benzo[j]fluoranthene",
                                    "benzo[k]fluoranthene",
                                    "cyclopenta[cd]pyrene",
                                    "dibenzo[a,h]anthracene",
                                    "indeno[1,2,3-cd]pyrene"),
                     "phase" = c("gas",
                                 "gas",
                                 "gas",
                                 "gas",
                                 "gas",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle",
                                 "particle"),
                     "NTP$^1$" = c("Known to be a human carcinogen",
                                   "Known to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "NA",
                                   "Reasonably anticipated to be a human carcinogen",
                                   "Reasonably anticipated to be a human carcinogen"),
                     "IARC$^2$" = c("Group 1: Carcinogenic to humans",
                                    "Group 1: Carcinogenic to humans",
                                    "Group 2A: Probably carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 1: Carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans",
                                    "Group 2A: Probably carcinogenic to humans",
                                    "Group 2A: Probably carcinogenic to humans",
                                    "Group 2B: Possibly carcinogenic to humans")) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c') %>%
    kable_styling(position = "center", latex_options = c("striped"), font_size = 8) %>%
    footnote(general_title = "Notes: ", threeparttable = TRUE,
             number = c("National Toxicology Program (NTP)",
                        "International Agency for Research on Cancer (IARC)"))
```

\pagebreak

# S13: R-squared plot for individual pollutant species

***Add description here

```{r, echo=FALSE, out.width = '60%', fig.align="center"}
  knitr::include_graphics("figures/models_all-1.png")
```

# S14: Bayesian information criterion plot for individual pollutant species

***Add description here

# S15: Linear regression model coefficients and confidence intervals for pollutant categories

***Add description here, if this ends up in primary SI

## S15.1: Stove type only

\[ln(EF) = \alpha_i\]

```{r}
  mod_1 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val") %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg")) %>%
    dplyr::arrange(pollutant, stove) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S15.2: PM$_{2.5}$ mass only

\[ln(EF) = \alpha + \beta \cdot PM_{2.5}\]

```{r}
  mod_2 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta$" = "pm_mass") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S15.3: CO only

\[ln(EF) = \alpha + \beta \cdot CO\]

```{r}
  mod_3 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta$" = "co") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S15.4: PM$_{2.5}$ mass and CO

\[ln(EF) = \alpha + \beta_1 \cdot CO + \beta_2 \cdot PM_{2.5}\]

```{r}
  mod_4 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta_1$" = "co",
                  "$\\beta_2$" = "pm_mass") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S15.5: PM$_{2.5}$ mass and stove type:

\[ln(EF) = \alpha_i + \beta \cdot PM_{2.5}\]

```{r}
  mod_5 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta$" = "pm_mass") %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg")) %>%
    dplyr::arrange(pollutant, stove) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S15.6: CO and stove type

\[ln(EF) = \alpha_i + \beta \cdot CO\]

```{r}
  mod_6 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta$" = "co") %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg")) %>%
    dplyr::arrange(pollutant, stove) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S15.7: PM$_{2.5}$ mass, CO, and stove type

\[ln(EF) = \alpha_i + \beta_1 \cdot CO + \beta_2 \cdot PM_{2.5}\]

```{r}
  mod_7 %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta_1$" = "co",
                  "$\\beta_2$" = "pm_mass") %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg")) %>%
    dplyr::arrange(pollutant, stove) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

# S16: Linear regression model coefficients and confidence intervals for pollutant categories

***Add description here, if this ends up in primary SI

## S16.1: Stove type only

\[ln(EF) = \alpha_i\]

```{r}
  mod_1_c %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val") %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg")) %>%
    dplyr::arrange(pollutant, stove) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S16.2: PM$_{2.5}$ mass only

\[ln(EF) = \alpha + \beta \cdot PM_{2.5}\]

```{r}
  mod_2_c %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta$" = "pm_mass") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S16.3: CO only

\[ln(EF) = \alpha + \beta \cdot CO\]

```{r}
  mod_3_c %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta$" = "co") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S16.4: PM$_{2.5}$ mass and CO

\[ln(EF) = \alpha + \beta_1 \cdot CO + \beta_2 \cdot PM_{2.5}\]

```{r}
  mod_4_c %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha$" = "(Intercept)",
                  "$\\beta_1$" = "co",
                  "$\\beta_2$" = "pm_mass") %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S16.5: PM$_{2.5}$ mass and stove type

\[ln(EF) = \alpha_i + \beta \cdot PM_{2.5}\]

```{r}
  mod_5_c %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta$" = "pm_mass") %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg")) %>%
    dplyr::arrange(pollutant, stove) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S16.6: CO and stove type

\[ln(EF) = \alpha_i + \beta \cdot CO\]

```{r}
  mod_6_c %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta$" = "co") %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg")) %>%
    dplyr::arrange(pollutant, stove) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```

## S16.7: PM$_{2.5}$ mass, CO, and stove type

\[ln(EF) = \alpha_i + \beta_1 \cdot CO + \beta_2 \cdot PM_{2.5}\]

```{r}
  mod_7_c %>%
    dplyr::rename("pollutant" = "pol",
                  "$\\alpha_i$" = "val",
                  "$\\beta_1$" = "co",
                  "$\\beta_2$" = "pm_mass") %>%
    dplyr::mutate(stove = 
                    stove %>% 
                    factor %>% 
                    forcats::fct_relevel("three-stone fire",
                                         "chulha",
                                         "rocket elbow",
                                         "built-in plancha",
                                         "fan rocket-elbow",
                                         "ceramic charcoal",
                                         "metal charcoal",
                                         "forced-draft gasifier",
                                         "wick kerosene",
                                         "pressure kerosene",
                                         "lpg")) %>%
    dplyr::arrange(pollutant, stove) %>%
    kable("latex", escape = FALSE,  booktabs = TRUE, align = 'c', longtable = TRUE) %>%
    kable_styling(position = "center", latex_options = c("striped", "repeat_header"), font_size = 10)
```