---
title: "Load and save data"
output:
  html_document:
    toc: true
    toc_float: true
    theme: united
---

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  library(tidyverse)
  library(forcats)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  source("../r_scripts/R_load_data.R")
  source("../r_scripts/R_load_metadata.R")
  source("../r_scripts/R_tidy.R")
  source("../r_scripts/R_functions.R")
```

# Pollutant data

## co2

Loads and saves the CO2 voltage data (`calibration?`)

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE} 
  co2 <- load_multifile(fldr = "../data/co2",
                            pattern = ".*_CO2.csv$", inst = "co2")

  saveRDS(co2, file = "../r_files/co2.RDS")
```

## ecoc

Loads ecoc data file and saves (`waiting on data`)

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE} 
  #ecoc <- load_singlefiles("ecoc")
  #saveRDS(ecoc, file = "../r_files/ecoc.RDS")
```  

## fivegas

The fivegas analyzer recorded co, co2 and ch4. Three file types are loaded; raw voltages, pre-calibrated mixing ratios (ppm) and voltage calibrations.The data is loaded and resaved as .Rda files.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  fivegas_conc <- load_fivegas(type = "conc")

  save(fivegas_conc, file = "../r_files/fivegas_conc.Rda")

  fivegas_volts <- load_fivegas(type = "volts")

  save(fivegas_volts, file = "../r_files/fivegas_volts.Rda")

  fivegas_calibration <- load_fivegas(pattern = "_CALIBRATION_",
                                      type = "volts")

  save(fivegas_calibration, file = "../r_files/fivegas_calibration.Rda")
```

## gravimetric

Loads filter weight data and resaves as .Rda.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  grav <- load_singlefiles("grav")

  save(grav, file = "../r_files/grav.Rda")
```

## ions and carbonyls

Loads and resaves data as .Rda.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE} 
  ions <- load_singlefiles("ions")

  save(ions, file = "../r_files/ions.Rda")
```

## pahs

Loads and resaves data as .Rda.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}   
  pah <- load_singlefiles("pah")

  save(pah, file = "../r_files/pah.Rda")
```

## pax

Loads and resaves data as .Rda.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  pax <- load_multifile(fldr = "../data/pax",
                        pattern = "ALLDAY_PAX.csv$", inst = "pax")

  save(pax, file = "../r_files/pax.Rda")
```

## scale

Loads and resaves data as .Rda.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE} 
  scale <- load_multifile(fldr = "../data/scale",
                          pattern = "_SCALE.xlsx$", inst = "scale")

  save(scale, file = "../r_files/scale.Rda")
```

## smps

Loads and resaves data as an .Rda.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE} 
  smps <- load_multifile(fldr = "../data/smps",
                         pattern = "_SMPS.csv$", inst = "smps")

  save(smps, file = "../r_files/smps.Rda")
```

## temperature

Loads and resaves data as an .Rda.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  temp <- load_multifile(fldr = "../data/temp",
                         pattern = "_TEMP.csv|_TEMP.CSV", inst = "temp")

  save(temp, file = "../r_files/temp.Rda")
```

## transmissometer

Loads and resaves data as an .Rda.

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  trans <- load_singlefiles("trans")

  save(trans, file = "../r_files/trans.Rda")
```
 
## vocs

Loads the microgram sheet  and resaves data as an .Rda.
 
```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  voc <- load_singlefiles("voc")

  save(voc, file = "../r_files/voc.Rda")
```

# Metadata

* Fuel preparation data

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  data_fuel_prep <- load_fuel_prep()
  saveRDS(data_fuel_prep, file = "../r_files/data_fuel_prep.RDS")
```

* Tester 1 log

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  data_tester_one <- load_test_one()
  saveRDS(data_tester_one, file = "../r_files/data_tester_one.RDS")
```

* Tester 2 log

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  data_tester_two <- load_test_two()
  saveRDS(data_tester_two, file = "../r_files/data_tester_two.RDS")
```
