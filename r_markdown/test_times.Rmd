---
title: "experiment metadata"
author: "Nicholas Good"
date: "11/21/2016"
output: html_document
---

## Libraries

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  library(tidyverse)
```

## Source files

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  source("../R_scripts/R_load_data.R")
  source("../R_scripts/R_load_metadata.R")
  source("../R_scripts/R_tidy.R")
```

## Load sample, wood and batch test meta data

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  load("../r_files/samples.Rda")
  load("../r_files/batch_times.Rda")
  load("../r_files/wood_times.Rda")
```

* Combine test types

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  test_times <- rbind(select(wood_times, -date), select(batch_times, -date))
  test_times <- dplyr::filter(inner_join(select(samples, id, date), test_times, by = "id"), is.na(value)==FALSE)
  test_times$id <- as.factor(test_times$id)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  # old code to output ignition and shutdown times only
  # times_ignite_shutdown <- dplyr::filter(test_times, var == "ignite" | var == "shutdown") %>%
  #                           tidyr::spread(var, value)
```

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  head(test_times)
```

## Save data

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  save(test_times, file = "../r_files/test_times.Rda")
```

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  load(file = "../r_files/samples.Rda") # load sample info
  samples <- dplyr::select(samples, id, stove, fuel)
```

## Summary

Test times were measured for `r length(unique(test_times$id))` experiments between `r min(test_times$date, na.rm = TRUE)` and `r max(test_times$date, na.rm = TRUE)`. There are times for tests: `r setdiff(levels(samples$id), levels(test_times$id))`.