---
title: "Emission Factor Summary"
output:
  html_document:
    toc: true
    toc_float: true
    theme: united
---

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  library(tidyverse)
  library(forcats)
```

# Load and tidy data

* Load data and meta data

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  load("../r_files/emissions_factors.Rda")
  load("../r_files/samples.Rda")
```

* Load functions

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  source("../r_scripts/R_functions.R")
```

* Output emissions factors column names 

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE}
  colnames(emissions_factors)
```

# CO data

* Plot emissions factors by mass, energy of fuel and energy delivered

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE, fig.width = 14,  fig.height = 10}
  plot_mass_ef(dplyr::filter(emissions, grepl('^co', pol)), 'CO')
```

# PM data

* Plot emissions factors by mass, energy of fuel and energy delivered

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE, fig.width = 14,  fig.height = 5}
  plot_mass_ef(dplyr::filter(emissions, grepl('grav', pol)), 'PM', "mass")
```

# VOC data

* Plot emissions factors by mass, energy of fuel and energy delivered

```{r, echo=FALSE, warning=FALSE, message=FALSE, results='markup', cache=FALSE, fig.width = 14,  fig.height = 10}
  plot_mass_ef(dplyr::filter(emissions, grepl('^voc_benzene|^voc_toluene', pol)), 'VOCs', "mass")
```
