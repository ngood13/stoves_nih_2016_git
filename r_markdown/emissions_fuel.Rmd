---
title: "Fuel burned"
output:
  html_document:
    toc: true
    toc_float: true
    theme: united
---

```{r, echo=FALSE, include=FALSE}
  library(tidyverse)
  library(knitr)
```

```{r global_options, include=FALSE}
  knitr::opts_chunk$set(fig.path = 'figures/', warning = FALSE, message = FALSE,
                        fig.width=10, fig.height = 4, cache = FALSE)
```

```{r}
  source("../r_scripts/R_functions.R")
```

---

# Load

* metadata

```{r}
  samples <- readRDS("../r_files/samples.RDS")
  test_times <- readRDS("../r_files/test_times_all.RDS")
  fuel_wgts <- readRDS("../r_files/fuel_wgts.RDS")
```

---

# Timestamps

```{r}
  times <- dplyr::filter(test_times, var == "set_1" | var == "end") %>%
           tidyr::spread(var, value) %>%
           dplyr::select(-date) %>%
           dplyr::rename(start = set_1, end = end)
```

---

# Fuel

* fuel consumed

```{r, eval = FALSE}
  fuel_burnt <- dplyr::filter(fuel_wgts, 
                             var == "start" |
                             var == "end") %>%
                tidyr::spread(var, value) %>%
                dplyr::mutate(delta_fuel = start - end)
```

```{r, fig.width = 12, fig.height = 8, eval = FALSE}
  p_data <- dplyr::left_join(samples, fuel_burnt) %>%
            dplyr::mutate(id = as.factor(id)) %>%
            dplyr::filter(grepl("^[0-9]", id) == TRUE)

  ggplot(p_data, aes(x = id, y = mass_fuel, colour = stove)) +
        geom_point() +
        theme_minimal() + 
        theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
        theme(legend.position = "top") +
        ylab("fuel burnt (g)")
```

---

# Save

```{r}
  saveRDS(fuel_burnt, file = "../r_files/fuel_burnt.RDS")
```

---

